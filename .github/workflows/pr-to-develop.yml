name: Pull Request to develop

on:
  pull_request_target:
    branches:
      - develop

jobs:
  pull-request-to-develop:
    name: Pull Request to Develop
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
          ref: "refs/pull/${{ github.event.number }}/merge"
      - name: Configure NPM Registry (Artifactory)
        run: |
          npm set always-auth true
          npm set email shawntompke@gmail.com
          npm i -g npm
        env:
          NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}
      - name: Install dependencies
        run: npm install
        env:
          NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}

      - name: Install dependencies
        run: npm install 
      - name: setup nvmrc
        run: echo //registry.npmjs.org/:_authToken=${NPM_TOKEN} > .npmrc
        env:
          NPM_TOKEN: ${{ secrets.NPM_TOKEN }}
      - id: project-name
        uses: actions-ecosystem/action-regex-match@v2
        with:
          text: ${{ github.event.pull_request.title }}
          regex: '^[a-z]+\(([a-zA-Z\-]+)\):.+$'
      - name: Get Affected Changed and Lint
        if: ${{ steps.project-name.outputs.group1 != '' }}
        id: lint
        uses: ./.github/actions/lint
        with:
          project: ${{ steps.project-name.outputs.group1 }}

